package it.gssi.cs.rastapms.presentation.api;


import it.gssi.cs.rastapms.RastaPMSApplication;
import it.gssi.cs.rastapms.domain.Difficulty;
import it.gssi.cs.rastapms.domain.Itinerary;
import it.gssi.cs.rastapms.domain.ItineraryCategory;
import it.gssi.cs.rastapms.domain.ItineraryState;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.extension.ExtendWith;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.http.MediaType;
import org.springframework.test.context.junit.jupiter.SpringExtension;
import org.springframework.test.context.web.WebAppConfiguration;
import org.springframework.test.web.servlet.MockMvc;
import org.springframework.test.web.servlet.MvcResult;
import org.springframework.test.web.servlet.request.MockMvcRequestBuilders;
import org.springframework.test.web.servlet.setup.MockMvcBuilders;
import org.springframework.web.context.WebApplicationContext;

import java.time.LocalTime;
import java.util.HashSet;
import java.util.Set;

import static org.junit.jupiter.api.Assertions.assertEquals;
import static org.junit.jupiter.api.Assertions.assertTrue;


@ExtendWith(SpringExtension.class)
@SpringBootTest(classes = RastaPMSApplication.class)
@WebAppConfiguration
public class RESTItineraryControllerTest {

    private static String MAP = "\n\"type\": \"FeatureCollection\",\n\"name\": \"PN Abruzzo, Lazio e Molise: M1\",\n\"crs\": { \"type\": \"name\", \"properties\": { \"name\": \"urn:ogc:def:crs:OGC:1.3:CRS84\" } },\n\"features\": [\n{ \"type\": \"Feature\", \"properties\": { \"Name\": \"Partenza\", \"description\": \"Le Forme \" }, \"geometry\": { \"type\": \"Point\", \"coordinates\": [ 13.977328888900001, 41.691991242699999 ] } },\n{ \"type\": \"Feature\", \"properties\": { \"Name\": \"Arrivo\", \"description\": \"Passo dei Monaci\" }, \"geometry\": { \"type\": \"Point\", \"coordinates\": [ 13.942215567, 41.684454786 ] } },\n{ \"type\": \"Feature\", \"properties\": { \"Name\": \"M1\", \"description\": null }, \"geometry\": { \"type\": \"LineString\", \"coordinates\": [ [ 13.9773288889475, 41.691991242738901 ], [ 13.9773481620001, 41.691759042 ], [ 13.977198796, 41.691703806000099 ], [ 13.977004672, 41.691675475000103 ], [ 13.976940969, 41.69162007 ], [ 13.976809792, 41.691618562 ], [ 13.976406958, 41.691578412 ], [ 13.976176456000101, 41.691571707 ], [ 13.9758331393629, 41.6915553377262 ], [ 13.975673458000101, 41.691553267000103 ], [ 13.975510513000099, 41.691580173 ], [ 13.975373972000099, 41.691606743000101 ], [ 13.975127460000101, 41.691623423000102 ], [ 13.9748926830001, 41.691658543000102 ], [ 13.9746563970001, 41.691655945 ], [ 13.974392619, 41.691589644 ], [ 13.974197656000101, 41.691579502 ], [ 13.97408559, 41.691642953 ], [ 13.9737763810001, 41.691527367 ], [ 13.973545041, 41.691497862000098 ], [ 13.973335745, 41.691406667000102 ], [ 13.973155302765299, 41.691270092668702 ], [ 13.973058555, 41.691231234 ], [ 13.972988147, 41.691048089 ], [ 13.972860575, 41.691019759000099 ], [ 13.97262672, 41.690959074 ], [ 13.972394625, 41.690820688 ], [ 13.9722735900001, 41.690760087 ], [ 13.9719439300001, 41.690752460000098 ], [ 13.9717287743836, 41.6907568853482 ], [ 13.971585017, 41.690835357 ], [ 13.971407153, 41.690860921000102 ], [ 13.97119794, 41.6909264680001 ], [ 13.9709088490001, 41.690970976000102 ], [ 13.970818937458599, 41.690990029638797 ], [ 13.9705956052241, 41.691038670197301 ], [ 13.9703605416681, 41.691075289696698 ], [ 13.970107371, 41.691106176 ], [ 13.969892459, 41.691112714 ], [ 13.969816184, 41.691187648000103 ], [ 13.9696868510001, 41.6913621590001 ], [ 13.96951016, 41.691425946000102 ], [ 13.969437741, 41.691528289000097 ], [ 13.969324166, 41.691626692 ], [ 13.969181254, 41.691915281 ], [ 13.969036331, 41.691983929000102 ], [ 13.968899203, 41.6919710210001 ], [ 13.968789736000099, 41.692015529000102 ], [ 13.968751263, 41.6921495550001 ], [ 13.968627211, 41.692206049000099 ], [ 13.968544062, 41.692185011 ], [ 13.9684189667843, 41.692204744751002 ], [ 13.968300652, 41.692251898000102 ], [ 13.9681946210001, 41.692247288 ], [ 13.9680580790001, 41.692314511000099 ], [ 13.968013153000101, 41.692396570000099 ], [ 13.9679902067162, 41.692424310809898 ], [ 13.967830343000101, 41.692420039 ], [ 13.967620041, 41.692310656000103 ], [ 13.967382833, 41.692330101000103 ], [ 13.967273366, 41.6923525650001 ], [ 13.967153085, 41.692241169 ], [ 13.967110924, 41.692207558000099 ], [ 13.967007625480701, 41.692233770917902 ], [ 13.96680817, 41.692281486000098 ], [ 13.966691494, 41.6921863520001 ], [ 13.966457136, 41.692151902 ], [ 13.966326797, 41.692117117000102 ], [ 13.966042735, 41.692081913000102 ], [ 13.965883311, 41.692044111 ], [ 13.9657922830001, 41.691984013000102 ], [ 13.965619029, 41.6919709370001 ], [ 13.965513061047, 41.6919998894099 ], [ 13.9653656450001, 41.692045703000097 ], [ 13.965183003, 41.692072609 ], [ 13.965103039, 41.6920389980001 ], [ 13.965039090834299, 41.692064135843601 ], [ 13.964876728, 41.692063389 ], [ 13.9646090100001, 41.692147879 ], [ 13.964448413000101, 41.692226417 ], [ 13.964364510000101, 41.692194063000102 ], [ 13.964034179, 41.692234212000102 ], [ 13.963820121745, 41.692240820219602 ], [ 13.9636647890001, 41.692278888 ], [ 13.963534618, 41.6922791390001 ], [ 13.963461099492299, 41.692323969810701 ], [ 13.9631671550001, 41.692428840000098 ], [ 13.962890217, 41.692470247000102 ], [ 13.962788126, 41.692541158000097 ], [ 13.9627333920001, 41.692508468 ], [ 13.9626034927169, 41.692518794566503 ], [ 13.962547313000099, 41.692574434 ], [ 13.9625766500001, 41.692698570000097 ], [ 13.96237649, 41.692710388000101 ], [ 13.96220969, 41.6927444190001 ], [ 13.962022858, 41.692798231 ], [ 13.961991845000099, 41.692880122000098 ], [ 13.961896878, 41.693016328000098 ], [ 13.961824542, 41.693012305000103 ], [ 13.9617432370001, 41.693036947000103 ], [ 13.961641984, 41.693006521 ], [ 13.961539725, 41.692959247 ], [ 13.961280221, 41.692946842 ], [ 13.961162036, 41.692949273000103 ], [ 13.961050892, 41.692855479000102 ], [ 13.960977383, 41.692910213 ], [ 13.9607956630001, 41.692966875 ], [ 13.96067664, 41.692909123000099 ], [ 13.960499531, 41.692877356 ], [ 13.9603901470001, 41.692794543000097 ], [ 13.9601550365548, 41.692782637122399 ], [ 13.960017571, 41.692855395 ], [ 13.9598236311564, 41.692877940721097 ], [ 13.959777933, 41.692883726 ], [ 13.9593306740001, 41.692919182 ], [ 13.9592583967456, 41.692932400505498 ], [ 13.959107883, 41.693000235000099 ], [ 13.959014652376601, 41.693013601265299 ], [ 13.958867155, 41.693008114000101 ], [ 13.958776882, 41.693025464 ], [ 13.958604131000101, 41.692965282 ], [ 13.958467087, 41.692902837000098 ], [ 13.958332473, 41.692838212 ], [ 13.958100378, 41.692746431000103 ], [ 13.9579728900001, 41.692705778000096 ], [ 13.957699975, 41.692684069000101 ], [ 13.957435708723599, 41.692591181156203 ], [ 13.957230421, 41.692557419 ], [ 13.9570392007608, 41.692533963391 ], [ 13.956832448, 41.692553563000097 ], [ 13.956588451, 41.692406461000097 ], [ 13.956556683, 41.692316439 ], [ 13.956498261, 41.692226753 ], [ 13.956378652000099, 41.692295736000098 ], [ 13.9562173, 41.692262459 ], [ 13.956199614, 41.692207139000097 ], [ 13.956100708, 41.692218538000098 ], [ 13.9560344070001, 41.692206301000098 ], [ 13.955988893, 41.692143688000101 ], [ 13.9559355840001, 41.692182831000103 ], [ 13.9559583830001, 41.692272350000103 ], [ 13.955951929, 41.692331945 ], [ 13.955880767, 41.692348123000102 ], [ 13.955761157, 41.692338735000099 ], [ 13.955625873, 41.692251312 ], [ 13.9555122140001, 41.692244019 ], [ 13.955474412, 41.692302274000099 ], [ 13.955370644, 41.692287438 ], [ 13.955288082, 41.692311075 ], [ 13.955159001, 41.692303279 ], [ 13.955107452, 41.692282408 ], [ 13.954980882002699, 41.692265038211801 ], [ 13.954862282, 41.692230692 ], [ 13.9548107330001, 41.6922291 ], [ 13.954728339, 41.692218957000101 ], [ 13.9546725990001, 41.692272853000098 ], [ 13.954609148, 41.692294311000097 ], [ 13.954563718, 41.692293808 ], [ 13.95448342, 41.692290539 ], [ 13.9543837590001, 41.692276709000097 ], [ 13.954328271, 41.692264304 ], [ 13.954257695, 41.692246618000098 ], [ 13.954199441, 41.692241169 ], [ 13.954060301, 41.692251228 ], [ 13.954000287, 41.692207474 ], [ 13.95392552, 41.69210027 ], [ 13.9538615660001, 41.692028353000097 ], [ 13.953798953, 41.691892650000099 ], [ 13.9537222590001, 41.691840850000098 ], [ 13.953588149, 41.691738926 ], [ 13.953418834, 41.691712439000099 ], [ 13.953287741, 41.691702967 ], [ 13.953174083, 41.691626273 ], [ 13.9531277310001, 41.691593835 ], [ 13.953014407, 41.69157221 ], [ 13.95287971, 41.691521583000103 ], [ 13.952505207, 41.691401889000097 ], [ 13.952349471, 41.6913848740001 ], [ 13.952225503, 41.691375989 ], [ 13.952097092, 41.691331984 ], [ 13.952009752, 41.691242885000101 ], [ 13.951795008, 41.691097375 ], [ 13.951693755, 41.691089999 ], [ 13.951611612, 41.691060662 ], [ 13.951484207, 41.691019507 ], [ 13.951430395, 41.6909946970001 ], [ 13.951233169, 41.690930827000102 ], [ 13.951095538, 41.690901490000101 ], [ 13.950967295, 41.690832088 ], [ 13.950843411000101, 41.690720022 ], [ 13.9508063200922, 41.690648195412599 ], [ 13.950739475, 41.690594545000103 ], [ 13.950444097, 41.690361779000099 ], [ 13.950194316, 41.690076627000103 ], [ 13.950163806, 41.689963220000102 ], [ 13.950119466, 41.689905049000103 ], [ 13.950001868000101, 41.6898000240001 ], [ 13.949858537, 41.689540269000098 ], [ 13.949874798, 41.689334325 ], [ 13.949906434928, 41.689287565962303 ], [ 13.949917043, 41.689214213000099 ], [ 13.9498864490001, 41.68916828 ], [ 13.949809922, 41.689120503 ], [ 13.9497468060001, 41.689046659 ], [ 13.949690396, 41.688947417000101 ], [ 13.949651839000101, 41.688843817000098 ], [ 13.949682601, 41.68874952 ], [ 13.949684026000099, 41.688658576000101 ], [ 13.949550250000099, 41.688587666 ], [ 13.949540779, 41.6885263940001 ], [ 13.949563159, 41.688448442 ], [ 13.949552765, 41.6883864160001 ], [ 13.949490068, 41.688350541 ], [ 13.9493942630001, 41.68828818 ], [ 13.9493441390001, 41.688213162 ], [ 13.949325951, 41.688116267 ], [ 13.949278928, 41.688014092000103 ], [ 13.949230062, 41.687937900000101 ], [ 13.949128389, 41.687892387 ], [ 13.949029986, 41.6878596970001 ], [ 13.948929654, 41.687728353000097 ], [ 13.948837202, 41.687725838000098 ], [ 13.948740391, 41.687629614000102 ], [ 13.948645173, 41.687612431 ], [ 13.9485509544597, 41.687598063978299 ], [ 13.948430512000099, 41.687530121000101 ], [ 13.948378125, 41.687499694000103 ], [ 13.94828232, 41.687430963 ], [ 13.9482434532505, 41.687446306169697 ], [ 13.948137648, 41.687325016 ], [ 13.947971603, 41.687232647 ], [ 13.947710423, 41.687168777000103 ], [ 13.947600704, 41.6871250230001 ], [ 13.947496517, 41.6870671880001 ], [ 13.947413452, 41.687050592000098 ], [ 13.9473681060001, 41.687007677 ], [ 13.947317898, 41.686973311 ], [ 13.947283952, 41.68689142 ], [ 13.947211281, 41.686836518 ], [ 13.947104663, 41.6867399590001 ], [ 13.946939036, 41.686658906 ], [ 13.946827976000099, 41.686554048000097 ], [ 13.9468397950001, 41.6865193470001 ], [ 13.946687160000099, 41.686387416000102 ], [ 13.9466167520001, 41.686311057000097 ], [ 13.946585823000101, 41.686246013000101 ], [ 13.946630917, 41.686193962 ], [ 13.946631001, 41.6861101430001 ], [ 13.9465872480001, 41.686008135000101 ], [ 13.94657786, 41.685946695000098 ], [ 13.946517762, 41.685964046000102 ], [ 13.9464653750001, 41.685984833000099 ], [ 13.946398823, 41.685984498 ], [ 13.946287595, 41.685913 ], [ 13.946044184, 41.685849130000101 ], [ 13.945916779, 41.685799593000098 ], [ 13.945784597, 41.6857219770001 ], [ 13.9455698520001, 41.685615107 ], [ 13.945390563, 41.685491307000099 ], [ 13.945275983, 41.68538033 ], [ 13.945225105, 41.6853298710001 ], [ 13.945085127, 41.685247645 ], [ 13.945021508, 41.685202718 ], [ 13.94494825, 41.685225936000101 ], [ 13.944812799000101, 41.685188301 ], [ 13.94459906, 41.685169861000098 ], [ 13.944382388000101, 41.685145805000097 ], [ 13.944196226, 41.68511915 ], [ 13.944118945000101, 41.685109846 ], [ 13.9441065097039, 41.685016330369599 ], [ 13.944191951, 41.684953775 ], [ 13.944148365, 41.684871549 ], [ 13.944044681, 41.684903400000103 ], [ 13.943960695, 41.684893928000101 ], [ 13.943872852, 41.684912369000102 ], [ 13.943764642, 41.684917984 ], [ 13.9436681660001, 41.6849064170001 ], [ 13.943599589363, 41.684910389689399 ], [ 13.943530284000101, 41.684951093000102 ], [ 13.943422241, 41.684981435 ], [ 13.943351833, 41.684940867000101 ], [ 13.9432570340001, 41.684934497 ], [ 13.943189057, 41.684945142000103 ], [ 13.943118313, 41.684956290000102 ], [ 13.943031141, 41.684938939 ], [ 13.942966852, 41.684886469000098 ], [ 13.942874148, 41.684810026 ], [ 13.942818744, 41.684778091000098 ], [ 13.942733416000101, 41.684741462 ], [ 13.942646412, 41.684751855000101 ], [ 13.9425032596065, 41.684696360481503 ], [ 13.9422155670844, 41.6844547860468 ] ] } }\n]\n}\n";
    private MockMvc mvc;
    private WebApplicationContext webApplicationContext;

    public RESTItineraryControllerTest(WebApplicationContext webApplicationContext) {
        this.webApplicationContext = webApplicationContext;
    }

    @BeforeEach
    void setUp() {
        mvc = MockMvcBuilders.webAppContextSetup(webApplicationContext).build();
    }

    @Test
    public void getItinerariesList() throws Exception {
        String uri = "/api/itineraries";
        MvcResult mvcResult = mvc.perform(MockMvcRequestBuilders.get(uri).accept(MediaType.APPLICATION_JSON_VALUE)).andReturn();
        int status = mvcResult.getResponse().getStatus();
        assertEquals(200, status);
        String content = mvcResult.getResponse().getContentAsString();
        Itinerary[] itinerarieslist = TestUtility.mapFromJson(content, Itinerary[].class);
        assertTrue(itinerarieslist.length > 0);
    }

    @Test
    public void getItineraryById() throws Exception {
        Long id = 1L;
        String uri = "/api/itineraries/" + id;
        MvcResult mvcResult = mvc.perform(MockMvcRequestBuilders.get(uri).accept(MediaType.APPLICATION_JSON_VALUE)).andReturn();
        int status = mvcResult.getResponse().getStatus();
        assertEquals(200, status);
        String content = mvcResult.getResponse().getContentAsString();
        Itinerary itinerary = TestUtility.mapFromJson(content, Itinerary.class);
        assertEquals(id, itinerary.getId());
    }

    @Test
    public void createItinerary() throws Exception {
        Itinerary itinerary = new Itinerary();
        itinerary.setCode("test-code");
        itinerary.setName("test-name");
        itinerary.setDescription("<p>prova inserimento rest api<br></p>");
        itinerary.setItineraryTime(LocalTime.now());
        itinerary.setLength(22.0F);
        Difficulty difficulty = new Difficulty();
        difficulty.setName("Turistico");
        difficulty.setAcronym("T");
        itinerary.setDifficulty(difficulty);
        ItineraryState state = new ItineraryState();
        state.setName("Aperto");
        itinerary.setState(state);
        ItineraryCategory bici = new ItineraryCategory();
        bici.setName("In Bici");
        Set<ItineraryCategory> categories = new HashSet<>();
        categories.add(bici);
        itinerary.setCategories(categories);
        itinerary.setMap(MAP);
        String uri = "/api/itineraries";
        //String json = TestUtility.mapToJson(itinerary);
        String json = "{\"code\":\"test-code\",\"name\":\"test-name\",\"description\":\"<p>prova inserimento rest api<br></p>\",\"itineraryTime\":\"22:22:00\",\"length\":22.0,\"difficulty\":{\"name\":\"Turistico\",\"acronym\":\"T\"},\"state\":{\"name\":\"Aperto\"},\"categories\":[{\"name\":\"In Bici\"}],\"map\":\"\\n\\\"type\\\": \\\"FeatureCollection\\\",\\n\\\"name\\\": \\\"PN Abruzzo, Lazio e Molise: M1\\\",\\n\\\"crs\\\": { \\\"type\\\": \\\"name\\\", \\\"properties\\\": { \\\"name\\\": \\\"urn:ogc:def:crs:OGC:1.3:CRS84\\\" } },\\n\\\"features\\\": [\\n{ \\\"type\\\": \\\"Feature\\\", \\\"properties\\\": { \\\"Name\\\": \\\"Partenza\\\", \\\"description\\\": \\\"Le Forme \\\" }, \\\"geometry\\\": { \\\"type\\\": \\\"Point\\\", \\\"coordinates\\\": [ 13.977328888900001, 41.691991242699999 ] } },\\n{ \\\"type\\\": \\\"Feature\\\", \\\"properties\\\": { \\\"Name\\\": \\\"Arrivo\\\", \\\"description\\\": \\\"Passo dei Monaci\\\" }, \\\"geometry\\\": { \\\"type\\\": \\\"Point\\\", \\\"coordinates\\\": [ 13.942215567, 41.684454786 ] } },\\n{ \\\"type\\\": \\\"Feature\\\", \\\"properties\\\": { \\\"Name\\\": \\\"M1\\\", \\\"description\\\": null }, \\\"geometry\\\": { \\\"type\\\": \\\"LineString\\\", \\\"coordinates\\\": [ [ 13.9773288889475, 41.691991242738901 ], [ 13.9773481620001, 41.691759042 ], [ 13.977198796, 41.691703806000099 ], [ 13.977004672, 41.691675475000103 ], [ 13.976940969, 41.69162007 ], [ 13.976809792, 41.691618562 ], [ 13.976406958, 41.691578412 ], [ 13.976176456000101, 41.691571707 ], [ 13.9758331393629, 41.6915553377262 ], [ 13.975673458000101, 41.691553267000103 ], [ 13.975510513000099, 41.691580173 ], [ 13.975373972000099, 41.691606743000101 ], [ 13.975127460000101, 41.691623423000102 ], [ 13.9748926830001, 41.691658543000102 ], [ 13.9746563970001, 41.691655945 ], [ 13.974392619, 41.691589644 ], [ 13.974197656000101, 41.691579502 ], [ 13.97408559, 41.691642953 ], [ 13.9737763810001, 41.691527367 ], [ 13.973545041, 41.691497862000098 ], [ 13.973335745, 41.691406667000102 ], [ 13.973155302765299, 41.691270092668702 ], [ 13.973058555, 41.691231234 ], [ 13.972988147, 41.691048089 ], [ 13.972860575, 41.691019759000099 ], [ 13.97262672, 41.690959074 ], [ 13.972394625, 41.690820688 ], [ 13.9722735900001, 41.690760087 ], [ 13.9719439300001, 41.690752460000098 ], [ 13.9717287743836, 41.6907568853482 ], [ 13.971585017, 41.690835357 ], [ 13.971407153, 41.690860921000102 ], [ 13.97119794, 41.6909264680001 ], [ 13.9709088490001, 41.690970976000102 ], [ 13.970818937458599, 41.690990029638797 ], [ 13.9705956052241, 41.691038670197301 ], [ 13.9703605416681, 41.691075289696698 ], [ 13.970107371, 41.691106176 ], [ 13.969892459, 41.691112714 ], [ 13.969816184, 41.691187648000103 ], [ 13.9696868510001, 41.6913621590001 ], [ 13.96951016, 41.691425946000102 ], [ 13.969437741, 41.691528289000097 ], [ 13.969324166, 41.691626692 ], [ 13.969181254, 41.691915281 ], [ 13.969036331, 41.691983929000102 ], [ 13.968899203, 41.6919710210001 ], [ 13.968789736000099, 41.692015529000102 ], [ 13.968751263, 41.6921495550001 ], [ 13.968627211, 41.692206049000099 ], [ 13.968544062, 41.692185011 ], [ 13.9684189667843, 41.692204744751002 ], [ 13.968300652, 41.692251898000102 ], [ 13.9681946210001, 41.692247288 ], [ 13.9680580790001, 41.692314511000099 ], [ 13.968013153000101, 41.692396570000099 ], [ 13.9679902067162, 41.692424310809898 ], [ 13.967830343000101, 41.692420039 ], [ 13.967620041, 41.692310656000103 ], [ 13.967382833, 41.692330101000103 ], [ 13.967273366, 41.6923525650001 ], [ 13.967153085, 41.692241169 ], [ 13.967110924, 41.692207558000099 ], [ 13.967007625480701, 41.692233770917902 ], [ 13.96680817, 41.692281486000098 ], [ 13.966691494, 41.6921863520001 ], [ 13.966457136, 41.692151902 ], [ 13.966326797, 41.692117117000102 ], [ 13.966042735, 41.692081913000102 ], [ 13.965883311, 41.692044111 ], [ 13.9657922830001, 41.691984013000102 ], [ 13.965619029, 41.6919709370001 ], [ 13.965513061047, 41.6919998894099 ], [ 13.9653656450001, 41.692045703000097 ], [ 13.965183003, 41.692072609 ], [ 13.965103039, 41.6920389980001 ], [ 13.965039090834299, 41.692064135843601 ], [ 13.964876728, 41.692063389 ], [ 13.9646090100001, 41.692147879 ], [ 13.964448413000101, 41.692226417 ], [ 13.964364510000101, 41.692194063000102 ], [ 13.964034179, 41.692234212000102 ], [ 13.963820121745, 41.692240820219602 ], [ 13.9636647890001, 41.692278888 ], [ 13.963534618, 41.6922791390001 ], [ 13.963461099492299, 41.692323969810701 ], [ 13.9631671550001, 41.692428840000098 ], [ 13.962890217, 41.692470247000102 ], [ 13.962788126, 41.692541158000097 ], [ 13.9627333920001, 41.692508468 ], [ 13.9626034927169, 41.692518794566503 ], [ 13.962547313000099, 41.692574434 ], [ 13.9625766500001, 41.692698570000097 ], [ 13.96237649, 41.692710388000101 ], [ 13.96220969, 41.6927444190001 ], [ 13.962022858, 41.692798231 ], [ 13.961991845000099, 41.692880122000098 ], [ 13.961896878, 41.693016328000098 ], [ 13.961824542, 41.693012305000103 ], [ 13.9617432370001, 41.693036947000103 ], [ 13.961641984, 41.693006521 ], [ 13.961539725, 41.692959247 ], [ 13.961280221, 41.692946842 ], [ 13.961162036, 41.692949273000103 ], [ 13.961050892, 41.692855479000102 ], [ 13.960977383, 41.692910213 ], [ 13.9607956630001, 41.692966875 ], [ 13.96067664, 41.692909123000099 ], [ 13.960499531, 41.692877356 ], [ 13.9603901470001, 41.692794543000097 ], [ 13.9601550365548, 41.692782637122399 ], [ 13.960017571, 41.692855395 ], [ 13.9598236311564, 41.692877940721097 ], [ 13.959777933, 41.692883726 ], [ 13.9593306740001, 41.692919182 ], [ 13.9592583967456, 41.692932400505498 ], [ 13.959107883, 41.693000235000099 ], [ 13.959014652376601, 41.693013601265299 ], [ 13.958867155, 41.693008114000101 ], [ 13.958776882, 41.693025464 ], [ 13.958604131000101, 41.692965282 ], [ 13.958467087, 41.692902837000098 ], [ 13.958332473, 41.692838212 ], [ 13.958100378, 41.692746431000103 ], [ 13.9579728900001, 41.692705778000096 ], [ 13.957699975, 41.692684069000101 ], [ 13.957435708723599, 41.692591181156203 ], [ 13.957230421, 41.692557419 ], [ 13.9570392007608, 41.692533963391 ], [ 13.956832448, 41.692553563000097 ], [ 13.956588451, 41.692406461000097 ], [ 13.956556683, 41.692316439 ], [ 13.956498261, 41.692226753 ], [ 13.956378652000099, 41.692295736000098 ], [ 13.9562173, 41.692262459 ], [ 13.956199614, 41.692207139000097 ], [ 13.956100708, 41.692218538000098 ], [ 13.9560344070001, 41.692206301000098 ], [ 13.955988893, 41.692143688000101 ], [ 13.9559355840001, 41.692182831000103 ], [ 13.9559583830001, 41.692272350000103 ], [ 13.955951929, 41.692331945 ], [ 13.955880767, 41.692348123000102 ], [ 13.955761157, 41.692338735000099 ], [ 13.955625873, 41.692251312 ], [ 13.9555122140001, 41.692244019 ], [ 13.955474412, 41.692302274000099 ], [ 13.955370644, 41.692287438 ], [ 13.955288082, 41.692311075 ], [ 13.955159001, 41.692303279 ], [ 13.955107452, 41.692282408 ], [ 13.954980882002699, 41.692265038211801 ], [ 13.954862282, 41.692230692 ], [ 13.9548107330001, 41.6922291 ], [ 13.954728339, 41.692218957000101 ], [ 13.9546725990001, 41.692272853000098 ], [ 13.954609148, 41.692294311000097 ], [ 13.954563718, 41.692293808 ], [ 13.95448342, 41.692290539 ], [ 13.9543837590001, 41.692276709000097 ], [ 13.954328271, 41.692264304 ], [ 13.954257695, 41.692246618000098 ], [ 13.954199441, 41.692241169 ], [ 13.954060301, 41.692251228 ], [ 13.954000287, 41.692207474 ], [ 13.95392552, 41.69210027 ], [ 13.9538615660001, 41.692028353000097 ], [ 13.953798953, 41.691892650000099 ], [ 13.9537222590001, 41.691840850000098 ], [ 13.953588149, 41.691738926 ], [ 13.953418834, 41.691712439000099 ], [ 13.953287741, 41.691702967 ], [ 13.953174083, 41.691626273 ], [ 13.9531277310001, 41.691593835 ], [ 13.953014407, 41.69157221 ], [ 13.95287971, 41.691521583000103 ], [ 13.952505207, 41.691401889000097 ], [ 13.952349471, 41.6913848740001 ], [ 13.952225503, 41.691375989 ], [ 13.952097092, 41.691331984 ], [ 13.952009752, 41.691242885000101 ], [ 13.951795008, 41.691097375 ], [ 13.951693755, 41.691089999 ], [ 13.951611612, 41.691060662 ], [ 13.951484207, 41.691019507 ], [ 13.951430395, 41.6909946970001 ], [ 13.951233169, 41.690930827000102 ], [ 13.951095538, 41.690901490000101 ], [ 13.950967295, 41.690832088 ], [ 13.950843411000101, 41.690720022 ], [ 13.9508063200922, 41.690648195412599 ], [ 13.950739475, 41.690594545000103 ], [ 13.950444097, 41.690361779000099 ], [ 13.950194316, 41.690076627000103 ], [ 13.950163806, 41.689963220000102 ], [ 13.950119466, 41.689905049000103 ], [ 13.950001868000101, 41.6898000240001 ], [ 13.949858537, 41.689540269000098 ], [ 13.949874798, 41.689334325 ], [ 13.949906434928, 41.689287565962303 ], [ 13.949917043, 41.689214213000099 ], [ 13.9498864490001, 41.68916828 ], [ 13.949809922, 41.689120503 ], [ 13.9497468060001, 41.689046659 ], [ 13.949690396, 41.688947417000101 ], [ 13.949651839000101, 41.688843817000098 ], [ 13.949682601, 41.68874952 ], [ 13.949684026000099, 41.688658576000101 ], [ 13.949550250000099, 41.688587666 ], [ 13.949540779, 41.6885263940001 ], [ 13.949563159, 41.688448442 ], [ 13.949552765, 41.6883864160001 ], [ 13.949490068, 41.688350541 ], [ 13.9493942630001, 41.68828818 ], [ 13.9493441390001, 41.688213162 ], [ 13.949325951, 41.688116267 ], [ 13.949278928, 41.688014092000103 ], [ 13.949230062, 41.687937900000101 ], [ 13.949128389, 41.687892387 ], [ 13.949029986, 41.6878596970001 ], [ 13.948929654, 41.687728353000097 ], [ 13.948837202, 41.687725838000098 ], [ 13.948740391, 41.687629614000102 ], [ 13.948645173, 41.687612431 ], [ 13.9485509544597, 41.687598063978299 ], [ 13.948430512000099, 41.687530121000101 ], [ 13.948378125, 41.687499694000103 ], [ 13.94828232, 41.687430963 ], [ 13.9482434532505, 41.687446306169697 ], [ 13.948137648, 41.687325016 ], [ 13.947971603, 41.687232647 ], [ 13.947710423, 41.687168777000103 ], [ 13.947600704, 41.6871250230001 ], [ 13.947496517, 41.6870671880001 ], [ 13.947413452, 41.687050592000098 ], [ 13.9473681060001, 41.687007677 ], [ 13.947317898, 41.686973311 ], [ 13.947283952, 41.68689142 ], [ 13.947211281, 41.686836518 ], [ 13.947104663, 41.6867399590001 ], [ 13.946939036, 41.686658906 ], [ 13.946827976000099, 41.686554048000097 ], [ 13.9468397950001, 41.6865193470001 ], [ 13.946687160000099, 41.686387416000102 ], [ 13.9466167520001, 41.686311057000097 ], [ 13.946585823000101, 41.686246013000101 ], [ 13.946630917, 41.686193962 ], [ 13.946631001, 41.6861101430001 ], [ 13.9465872480001, 41.686008135000101 ], [ 13.94657786, 41.685946695000098 ], [ 13.946517762, 41.685964046000102 ], [ 13.9464653750001, 41.685984833000099 ], [ 13.946398823, 41.685984498 ], [ 13.946287595, 41.685913 ], [ 13.946044184, 41.685849130000101 ], [ 13.945916779, 41.685799593000098 ], [ 13.945784597, 41.6857219770001 ], [ 13.9455698520001, 41.685615107 ], [ 13.945390563, 41.685491307000099 ], [ 13.945275983, 41.68538033 ], [ 13.945225105, 41.6853298710001 ], [ 13.945085127, 41.685247645 ], [ 13.945021508, 41.685202718 ], [ 13.94494825, 41.685225936000101 ], [ 13.944812799000101, 41.685188301 ], [ 13.94459906, 41.685169861000098 ], [ 13.944382388000101, 41.685145805000097 ], [ 13.944196226, 41.68511915 ], [ 13.944118945000101, 41.685109846 ], [ 13.9441065097039, 41.685016330369599 ], [ 13.944191951, 41.684953775 ], [ 13.944148365, 41.684871549 ], [ 13.944044681, 41.684903400000103 ], [ 13.943960695, 41.684893928000101 ], [ 13.943872852, 41.684912369000102 ], [ 13.943764642, 41.684917984 ], [ 13.9436681660001, 41.6849064170001 ], [ 13.943599589363, 41.684910389689399 ], [ 13.943530284000101, 41.684951093000102 ], [ 13.943422241, 41.684981435 ], [ 13.943351833, 41.684940867000101 ], [ 13.9432570340001, 41.684934497 ], [ 13.943189057, 41.684945142000103 ], [ 13.943118313, 41.684956290000102 ], [ 13.943031141, 41.684938939 ], [ 13.942966852, 41.684886469000098 ], [ 13.942874148, 41.684810026 ], [ 13.942818744, 41.684778091000098 ], [ 13.942733416000101, 41.684741462 ], [ 13.942646412, 41.684751855000101 ], [ 13.9425032596065, 41.684696360481503 ], [ 13.9422155670844, 41.6844547860468 ] ] } }\\n]\\n}\\n\"}\n";
        System.out.println(json);
        MvcResult mvcResult = mvc.perform(MockMvcRequestBuilders.post(uri)
                .contentType(MediaType.APPLICATION_JSON)
                .content(json)
                .accept(MediaType.APPLICATION_JSON_VALUE)).andReturn();
        int status = mvcResult.getResponse().getStatus();
        assertEquals(200, status);
        String content = mvcResult.getResponse().getContentAsString();
        Itinerary itineraryAdded = TestUtility.mapFromJson(content, Itinerary.class);
        assertTrue(itineraryAdded.getId()!=0);
    }


}
